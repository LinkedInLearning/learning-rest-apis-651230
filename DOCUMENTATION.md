# Library REST API

A prototype FastAPI-based library management system provided as a practivce environment for the LinkedIn Learning course "Learning REST APIs.

## Setup and Installation
The system sets up automatically when run in GitHub Codespaces. This documentation is provided for completeness and to support further exploration.

> [!NOTE]
> The following was generated by GitHub Copilot based on the contents of the repository:

### Prerequisites
- Python 3.8+
- PostgreSQL database

### Installation
1. Clone the repository
2. Install dependencies:
   ```bash
   pip install -r requirements.txt
   ```
3. Create a `.env` file with your database configuration:
   ```
   DBUSER=your_db_user
   DBPASS=your_db_password
   DBHOST=your_db_host
   DBNAME=your_db_name
   ```
4. Run the application:
   ```bash
   uvicorn main:app --reload
   ```

The API will be available at `http://localhost:8000`

## Database Models

### User
Stores user information including:
- `user_id` (int, primary key) - Auto-generated starting from 100000
- `name` (string, required) - User's full name
- `email` (string, required, unique) - User's email address
- `member_since` (date) - Registration date (auto-set to today)
- `fine_balance` (decimal) - Outstanding fines (default: 0.00)
- `address` (string, optional) - User's address
- `phone_number` (string, optional) - User's phone number

### Book
Stores book information with:
- `isbn` (bigint, primary key) - International Standard Book Number
- `title` (string, required) - Book title
- `author` (string, required) - Book author
- `publisher` (string, optional) - Publisher name
- `year` (int, optional) - Publication year
- `pages` (int, optional) - Number of pages
- `genre` (string, optional) - Book genre
- `location` (string, optional) - Physical location in library
- `is_available` (boolean) - Availability status (default: true)

### Checkout
Tracks book borrowing with:
- `checkout_id` (int, primary key, auto-increment) - Unique checkout identifier
- `user_id` (int, foreign key) - References User
- `isbn` (bigint, foreign key) - References Book
- `checkout_date` (datetime) - When book was checked out (auto-set)
- `due_date` (datetime) - When book is due (30 days from checkout)
- `return_date` (datetime, optional) - When book was returned

## API Endpoints

### Root
- **GET** `/`
  - Returns welcome message with documentation link

### Users

#### Get All Users
- **GET** `/users`
- **Response**: Array of user objects with basic info
  ```json
  [
    {
      "userId": 100000,
      "name": "John Doe",
      "email": "john@example.com"
    }
  ]
  ```

#### Get User by ID
- **GET** `/users/{user_id}`
- **Parameters**: 
  - `user_id` (path, int) - User's unique identifier
- **Response**: Detailed user information including checked out books
  ```json
  {
    "userId": 100000,
    "name": "John Doe",
    "email": "john@example.com",
    "memberSince": "2025-06-27",
    "checkedOutBooks": [9781234567890],
    "fineBalance": 1.50,
    "address": "123 Main St",
    "phoneNumber": "555-0123"
  }
  ```
- **Errors**: 
  - `404` - User not found

#### Create New User
- **POST** `/users`
- **Request Body**:
  ```json
  {
    "name": "Jane Smith",
    "email": "jane@example.com",
    "address": "456 Oak Ave",
    "phoneNumber": "555-0456"
  }
  ```
- **Response**: 
  ```json
  {
    "message": "User created with ID 100001"
  }
  ```
- **Errors**: 
  - `400` - Email already registered

### Books

#### Get All Books
- **GET** `/books`
- **Response**: Array of book objects with basic info
  ```json
  [
    {
      "isbn": 9781234567890,
      "title": "The Great Gatsby",
      "author": "F. Scott Fitzgerald",
      "available": true
    }
  ]
  ```

#### Get Book by ISBN
- **GET** `/books/{isbn}`
- **Parameters**: 
  - `isbn` (path, int) - Book's ISBN
- **Response**: Detailed book information
  ```json
  {
    "isbn": 9781234567890,
    "title": "The Great Gatsby",
    "author": "F. Scott Fitzgerald",
    "publisher": "Scribner",
    "year": 1925,
    "pages": 180,
    "genre": "Fiction",
    "location": "A-1-B"
  }
  ```
- **Errors**: 
  - `404` - Book not found

#### Add New Book
- **POST** `/books`
- **Request Body**:
  ```json
  {
    "isbn": 9781234567890,
    "title": "The Great Gatsby",
    "author": "F. Scott Fitzgerald",
    "publisher": "Scribner",
    "year": 1925,
    "pages": 180,
    "genre": "Fiction",
    "location": "A-1-B"
  }
  ```
- **Response**: 
  ```json
  {
    "message": "Book 'The Great Gatsby' added to library"
  }
  ```
- **Errors**: 
  - `400` - Book with this ISBN already exists

### Library Operations

#### Check Out Book
- **POST** `/checkout`
- **Request Body**:
  ```json
  {
    "userId": 100000,
    "isbn": 9781234567890
  }
  ```
- **Response**: 
  ```json
  {
    "message": "Book 'The Great Gatsby' checked out to John Doe",
    "dueDate": "2025-07-27T23:59:59"
  }
  ```
- **Errors**: 
  - `404` - User not found
  - `404` - Book not found
  - `400` - Book is not available

#### Return Book
- **POST** `/return/{isbn}`
- **Parameters**: 
  - `isbn` (path, int) - Book's ISBN to return
- **Query Parameters**: 
  - `user_id` (int, required) - ID of user returning the book
- **Response** (on time): 
  ```json
  {
    "message": "Book returned successfully"
  }
  ```
- **Response** (late): 
  ```json
  {
    "message": "Book returned. Late fee of $5.00 applied."
  }
  ```
- **Errors**: 
  - `404` - No active checkout found for this book and user

## Business Rules

- Books have a 30-day checkout period
- Late fees are calculated at $0.50 per day
- Users cannot check out books if they have the same book already checked out
- ISBN must be unique for each book
- Email must be unique for each user
- User IDs start at 100000 and increment automatically

## Interactive API Documentation

Once the server is running, visit:
- **Swagger UI**: `http://localhost:8000/docs`
- **ReDoc**: `http://localhost:8000/redoc`

These provide interactive documentation where you can test the API endpoints directly.

